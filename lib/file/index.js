"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function c(t,e){return new Promise((i,s)=>{const n=new FileReader;n["readAs"+e](t),n.onload=l=>{i(l.target.result)},n.onerror=l=>{s(l)}})}async function o(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;const i=typeof e=="string",s=e&&e.length;try{const n=[],l=await window.showOpenFilePicker(t);for(const u of l){const r=await u.getFile();if(e){const a={file:r};if(i)a[e]=await c(r,e);else if(s)for(let g=0;g<s;g++){const f=e[g];a[f]=await c(r,f)}n.push(a);continue}n.push(r)}return n}catch(n){return Promise.reject(n)}}async function F(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"DataURL";const i=typeof e=="string",s=e&&e.length;try{const n=[];for(const l of t){const u={file:l};if(i)u[e]=await c(l,e);else if(s)for(let r=0;r<s;r++){const a=e[r];u[a]=await c(l,a)}n.push(u)}return n}catch(n){return Promise.reject(n)}}const y={img:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excel:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],xml:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],pdf:[{description:"选择PDF文件",accept:{"application/vnd.sealedmedia.softseal.pdf":[".pdf"]}}],zip:[{description:"选择压缩文件",accept:{"application/zip":[".zip"],"application/x-7z-compressed":[".7z"],"application/x-rar-compressed":[".rar"]}}],video:[{description:"选择视频文件",accept:{"video/*":[]}}]};function d(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{types:y[t],excludeAcceptAllOption:!0,multiple:e}}async function x(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("img"),...t},e)}async function v(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("video"),...t},e)}async function w(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("excel"),...t},e)}async function P(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("xml"),...t},e)}async function b(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("pdf"),...t},e)}async function z(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return o({...d("zip"),...t},e)}async function m(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return new Promise((i,s)=>{try{const n=document.createElement("input");n.type="file",t.multiple&&(n.multiple="multiple"),n.accept=t.accept,n.onchange=async l=>{const u=[...l.target.files];if(e){const r=[];for(let a=0;a<u.length;a++){const g=u[a],f={file:g};if(typeof e=="string")f[e]=await c(g,e);else if(e.length)for(let p=0;p<e.length;p++){const h=e[p];f[h]=await c(g,h)}r.push(f)}i(r)}else i(u)},n.click()}catch(n){s(n)}})}async function L(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"image/*"},e)}async function j(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"video/*"},e)}async function A(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".xls,.xlsx"},e)}async function I(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"xml/*"},e)}async function R(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".pdf"},e)}async function E(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".zip,.rar,.7z"},e)}function O(t,e){const i=URL.createObjectURL(t),s=document.createElement("a");s.href=i,s.download=e,s.click(),setTimeout(()=>{URL.revokeObjectURL(i)},5e3)}function U(t){const e=t.split(","),i=window.atob(e[1]),s=e[0].match(/:(.*?);/)[1],n=new Uint8Array(i.length);for(var l=0;l<i.length;l++)n[l]=i.charCodeAt(l);return new Blob([n],{type:s})}exports.base64ToBlob=U;exports.exportFile=O;exports.filesHandle=F;exports.getExcelFile=w;exports.getExcelFile2=A;exports.getFile=o;exports.getImgFile=x;exports.getImgFile2=L;exports.getInputFile=m;exports.getPdfFile=b;exports.getPdfFile2=R;exports.getVideoFile=v;exports.getVideoFile2=j;exports.getXmlFile=P;exports.getXmlFile2=I;exports.getZipFile=z;exports.getZipFile2=E;exports.readFileAs=c;
