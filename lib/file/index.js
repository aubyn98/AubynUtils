"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function f(t,e){return new Promise((i,c)=>{const l=new FileReader;l["readAs"+e](t),l.onload=n=>{i(n.target.result)},l.onerror=n=>{c(n)}})}async function s(t={multiple:!1},e){try{const i=[],c=await window.showOpenFilePicker(t);for(const l of c){const n=await l.getFile();if(e){const a={file:n};if(typeof e=="string")a[e]=await f(n,e);else if(e.length)for(let p=0;p<e.length;p++){const r=e[p];a[r]=await f(n,r)}i.push(a);continue}i.push(n)}return i}catch(i){return Promise.reject(i)}}async function y(t=[]){try{const e=[];for(const i of t){const c=await f(i,"DataURL");e.push({dataURL:c,file:i})}return e}catch(e){return Promise.reject(e)}}const x={img:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excel:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],xml:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],pdf:[{description:"选择PDF文件",accept:{"application/vnd.sealedmedia.softseal.pdf":[".pdf"]}}],zip:[{description:"选择压缩文件",accept:{"application/zip":[".zip"],"application/x-7z-compressed":[".7z"],"application/x-rar-compressed":[".rar"]}}],video:[{description:"选择视频文件",accept:{"video/*":[]}}]};function u(t,e=!1){return{types:x[t],excludeAcceptAllOption:!0,multiple:e}}async function h(t={multiple:!1},e){return s({...u("img"),...t},e)}async function w(t={multiple:!1},e){return s({...u("video"),...t},e)}async function P(t={multiple:!1},e){return s({...u("excel"),...t},e)}async function b(t={multiple:!1},e){return s({...u("xml"),...t},e)}async function L(t={multiple:!1},e){return s({...u("pdf"),...t},e)}async function z(t={multiple:!1},e){return s({...u("zip"),...t},e)}async function o(t={multiple:!1},e){return new Promise((i,c)=>{try{const l=document.createElement("input");l.type="file",t.multiple&&(l.multiple="multiple"),l.accept=t.accept,l.onchange=async n=>{const a=[...n.target.files];if(e){const p=[];for(let r=0;r<a.length;r++){const m=a[r],g={file:m};if(typeof e=="string")g[e]=await f(m,e);else if(e.length)for(let d=0;d<e.length;d++){const F=e[d];g[F]=await f(m,F)}p.push(g)}i(p)}else i(a)},l.click()}catch(l){c(l)}})}async function R(t={multiple:!1},e){return o({...t,accept:"image/*"},e)}async function j(t={multiple:!1},e){return o({...t,accept:"video/*"},e)}async function A(t={multiple:!1},e){return o({...t,accept:".xls,.xlsx"},e)}async function I(t={multiple:!1},e){return o({...t,accept:"xml/*"},e)}async function U(t={multiple:!1},e){return o({...t,accept:".pdf"},e)}async function E(t={multiple:!1},e){return o({...t,accept:".zip,.rar,.7z"},e)}function O(t,e){const i=URL.createObjectURL(t),c=document.createElement("a");c.href=i,c.download=e,c.click(),setTimeout(()=>{URL.revokeObjectURL(i)},5e3)}function k(t){const e=t.split(","),i=window.atob(e[1]),c=e[0].match(/:(.*?);/)[1],l=new Uint8Array(i.length);for(var n=0;n<i.length;n++)l[n]=i.charCodeAt(n);return new Blob([l],{type:c})}exports.base64ToBlob=k;exports.exportFile=O;exports.getExcelFile=P;exports.getExcelFile2=A;exports.getFile=s;exports.getImgFile=h;exports.getImgFile2=R;exports.getInputFile=o;exports.getPdfFile=L;exports.getPdfFile2=U;exports.getVideoFile=w;exports.getVideoFile2=j;exports.getXmlFile=b;exports.getXmlFile2=I;exports.getZipFile=z;exports.getZipFile2=E;exports.imgFilesHandle=y;exports.readFileAs=f;
