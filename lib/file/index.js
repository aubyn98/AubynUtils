"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function o(t,e){return new Promise((r,l)=>{const n=new FileReader;n["readAs"+e](t),n.onload=i=>{r(i.target.result)},n.onerror=i=>{l(i)}})}async function c(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;const r=typeof e=="string",l=e&&e.length;try{const n=[],i=await window.showOpenFilePicker(t);for(const u of i){const s=await u.getFile();if(e){const a={file:s};if(r)a[e]=await o(s,e);else if(l)for(let g=0;g<l;g++){const f=e[g];a[f]=await o(s,f)}n.push(a);continue}n.push(s)}return n}catch(n){return Promise.reject(n)}}async function y(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"DataURL";const r=typeof e=="string",l=e&&e.length;try{const n=[];for(const i of t){const u={file:i};if(r)u[e]=await o(i,e);else if(l)for(let s=0;s<l;s++){const a=e[s];u[a]=await o(i,a)}n.push(u)}return n}catch(n){return Promise.reject(n)}}const F={img:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excel:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],xml:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],pdf:[{description:"选择PDF文件",accept:{"application/vnd.sealedmedia.softseal.pdf":[".pdf"]}}],zip:[{description:"选择压缩文件",accept:{"application/zip":[".zip"],"application/x-7z-compressed":[".7z"],"application/x-rar-compressed":[".rar"]}}],video:[{description:"选择视频文件",accept:{"video/*":[]}}]};function d(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{types:F[t],excludeAcceptAllOption:!0,multiple:e}}async function x(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("img"),...t},e)}async function v(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("video"),...t},e)}async function w(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("excel"),...t},e)}async function b(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("xml"),...t},e)}async function A(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("pdf"),...t},e)}async function P(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return c({...d("zip"),...t},e)}async function m(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return new Promise((r,l)=>{try{const n=document.createElement("input");n.type="file",t.multiple&&(n.multiple="multiple"),n.accept=t.accept,n.onchange=async i=>{const u=[...i.target.files];if(e){const s=[];for(let a=0;a<u.length;a++){const g=u[a],f={file:g};if(typeof e=="string")f[e]=await o(g,e);else if(e.length)for(let p=0;p<e.length;p++){const h=e[p];f[h]=await o(g,h)}s.push(f)}r(s)}else r(u)},n.click()}catch(n){l(n)}})}async function S(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"image/*"},e)}async function U(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"video/*"},e)}async function B(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".xls,.xlsx"},e)}async function I(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:"xml/*"},e)}async function R(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".pdf"},e)}async function T(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{multiple:!1},e=arguments.length>1?arguments[1]:void 0;return m({...t,accept:".zip,.rar,.7z"},e)}function z(t,e){const r=URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download=e,l.click(),setTimeout(()=>{URL.revokeObjectURL(r)},5e3)}function L(t){const e=t.split(","),r=window.atob(e[1]),l=e[0].match(/:(.*?);/)[1],n=new Uint8Array(r.length);for(var i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return new Blob([n],{type:l})}function j(t){const e=new Uint8Array(t);let r="";for(let i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);const l=encodeURIComponent(r);return btoa(l)}function C(t){const e=atob(t),r=decodeURIComponent(e),l=new Uint8Array(r.length);for(let n=0;n<r.length;n++)l[n]=r.charCodeAt(n);return l.buffer}exports.arrayBufferToBase64=j;exports.base64ToArrayBuffer=C;exports.base64ToBlob=L;exports.exportFile=z;exports.filesHandle=y;exports.getExcelFile=w;exports.getExcelFile2=B;exports.getFile=c;exports.getImgFile=x;exports.getImgFile2=S;exports.getInputFile=m;exports.getPdfFile=A;exports.getPdfFile2=R;exports.getVideoFile=v;exports.getVideoFile2=U;exports.getXmlFile=b;exports.getXmlFile2=I;exports.getZipFile=P;exports.getZipFile2=T;exports.readFileAs=o;
