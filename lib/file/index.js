"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function a(n,t){return new Promise((i,e)=>{const l=new FileReader;l["readAs"+t](n),l.onload=c=>{i(c.target.result)},l.onerror=c=>{e(c)}})}async function s(n={multiple:!1}){try{const t=[],i=await window.showOpenFilePicker(n);for(const e of i){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}async function u(n=[]){try{const t=[];for(const i of n){const e=await a(i,"DataURL");t.push({dataURL:e,file:i})}return t}catch(t){return Promise.reject(t)}}const p={types:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excludeAcceptAllOption:!0};async function m(n={multiple:!1},t=!1){try{const i=[],e=await window.showOpenFilePicker({...p,...n});for(const l of e){const c=await l.getFile();if(t){const r=await a(c,"DataURL");i.push({dataURL:r,file:c});continue}i.push({file:c})}return i}catch(i){return Promise.reject(i)}}const f={types:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0};async function g(n={multiple:!1}){try{const t=[],i=await window.showOpenFilePicker({...f,...n});for(const e of i){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}const d={types:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],excludeAcceptAllOption:!0};async function F(n={multiple:!1}){try{const t=[],i=await window.showOpenFilePicker({...d,...n});for(const e of i){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}async function o(n={multiple:!1}){return new Promise((t,i)=>{try{const e=document.createElement("input");e.type="file",n.multiple&&(e.multiple="multiple"),e.accept=n.accept,e.onchange=l=>{t([...l.target.files])},e.click()}catch(e){i(e)}})}async function w(n={multiple:!1},t=!1){return o({...n,accept:"image/*"}).then(i=>t?Promise.all(i.map(e=>a(e,"DataURL").then(l=>({dataURL:l,file:e})))):i.map(e=>({file:e})))}async function h(n={multiple:!1},t=!1){return o({...n,accept:"video/*"}).then(i=>t?Promise.all(i.map(e=>a(e,"DataURL").then(l=>({dataURL:l,file:e})))):i.map(e=>({file:e})))}async function y(n={multiple:!1}){return o({...n,accept:".xls,.xlsx"})}async function x(n={multiple:!1}){return o({...n,accept:"xml/*"})}function P(n,t){const i=URL.createObjectURL(n),e=document.createElement("a");e.href=i,e.download=t,e.click(),setTimeout(()=>{URL.revokeObjectURL(i)},5e3)}function L(n){const t=n.split(","),i=window.atob(t[1]),e=t[0].match(/:(.*?);/)[1],l=new Uint8Array(i.length);for(var c=0;c<i.length;c++)l[c]=i.charCodeAt(c);return new Blob([l],{type:e})}exports.base64ToBlob=L;exports.exportFile=P;exports.getExcelFile=g;exports.getExcelFile2=y;exports.getFile=s;exports.getImgFile=m;exports.getImgFile2=w;exports.getInputFile=o;exports.getVideoFile2=h;exports.getXmlFile=F;exports.getXmlFile2=x;exports.imgFilesHandle=u;exports.readFileAs=a;
