"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function r(t,e){return new Promise((n,c)=>{const i=new FileReader;i["readAs"+e](t),i.onload=l=>{n(l.target.result)},i.onerror=l=>{c(l)}})}async function f(t={multiple:!1},e){const n=typeof e=="string",c=e&&e.length;try{const i=[],l=await window.showOpenFilePicker(t);for(const o of l){const s=await o.getFile();if(e){const a={file:s};if(n)a[e]=await r(s,e);else if(c)for(let p=0;p<c;p++){const g=e[p];a[g]=await r(s,g)}i.push(a);continue}i.push(s)}return i}catch(i){return Promise.reject(i)}}async function y(t=[],e="DataURL"){const n=typeof e=="string",c=e&&e.length;try{const i=[];for(const l of t){const o={file:l};if(n)o[e]=await r(l,e);else if(c)for(let s=0;s<c;s++){const a=e[s];o[a]=await r(l,a)}i.push(o)}return i}catch(i){return Promise.reject(i)}}const x={img:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excel:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],xml:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],pdf:[{description:"选择PDF文件",accept:{"application/vnd.sealedmedia.softseal.pdf":[".pdf"]}}],zip:[{description:"选择压缩文件",accept:{"application/zip":[".zip"],"application/x-7z-compressed":[".7z"],"application/x-rar-compressed":[".rar"]}}],video:[{description:"选择视频文件",accept:{"video/*":[]}}]};function m(t,e=!1){return{types:x[t],excludeAcceptAllOption:!0,multiple:e}}async function h(t={multiple:!1},e){return f({...m("img"),...t},e)}async function w(t={multiple:!1},e){return f({...m("video"),...t},e)}async function P(t={multiple:!1},e){return f({...m("excel"),...t},e)}async function b(t={multiple:!1},e){return f({...m("xml"),...t},e)}async function z(t={multiple:!1},e){return f({...m("pdf"),...t},e)}async function L(t={multiple:!1},e){return f({...m("zip"),...t},e)}async function u(t={multiple:!1},e){return new Promise((n,c)=>{try{const i=document.createElement("input");i.type="file",t.multiple&&(i.multiple="multiple"),i.accept=t.accept,i.onchange=async l=>{const o=[...l.target.files];if(e){const s=[];for(let a=0;a<o.length;a++){const p=o[a],g={file:p};if(typeof e=="string")g[e]=await r(p,e);else if(e.length)for(let d=0;d<e.length;d++){const F=e[d];g[F]=await r(p,F)}s.push(g)}n(s)}else n(o)},i.click()}catch(i){c(i)}})}async function j(t={multiple:!1},e){return u({...t,accept:"image/*"},e)}async function A(t={multiple:!1},e){return u({...t,accept:"video/*"},e)}async function I(t={multiple:!1},e){return u({...t,accept:".xls,.xlsx"},e)}async function R(t={multiple:!1},e){return u({...t,accept:"xml/*"},e)}async function E(t={multiple:!1},e){return u({...t,accept:".pdf"},e)}async function O(t={multiple:!1},e){return u({...t,accept:".zip,.rar,.7z"},e)}function U(t,e){const n=URL.createObjectURL(t),c=document.createElement("a");c.href=n,c.download=e,c.click(),setTimeout(()=>{URL.revokeObjectURL(n)},5e3)}function k(t){const e=t.split(","),n=window.atob(e[1]),c=e[0].match(/:(.*?);/)[1],i=new Uint8Array(n.length);for(var l=0;l<n.length;l++)i[l]=n.charCodeAt(l);return new Blob([i],{type:c})}exports.base64ToBlob=k;exports.exportFile=U;exports.filesHandle=y;exports.getExcelFile=P;exports.getExcelFile2=I;exports.getFile=f;exports.getImgFile=h;exports.getImgFile2=j;exports.getInputFile=u;exports.getPdfFile=z;exports.getPdfFile2=E;exports.getVideoFile=w;exports.getVideoFile2=A;exports.getXmlFile=b;exports.getXmlFile2=R;exports.getZipFile=L;exports.getZipFile2=O;exports.readFileAs=r;
