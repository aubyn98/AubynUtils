"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("./array/index.js"),d=require("./date/index.js"),g=require("./EventBus/index.js"),t=require("./file/index.js"),r=require("./magic/index.js"),n=require("./num/index.js"),a=require("./object/index.js"),c=require("./storage/index.js"),e=require("./str/index.js");require("lodash");class h{constructor(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.url=i,this.reconnectDelay=s.reconnectDelay||1e3,this.heartbeatInterval=s.heartbeatInterval||6e4,this.heartbeatMsg=s.heartbeatMsg||"ping",this.ws=null,this.isConnected=!1,this.heartbeatTimer=null,this.reconnectTimer=null}connect(){const i=this.ws=new WebSocket(this.url);return i.addEventListener("open",()=>{this.isConnected=!0,console.log("Connection established"),this.startHeartbeat()}),i.addEventListener("close",()=>{this.isConnected=!1,console.log("Connection closed"),this.reconnect()}),i.addEventListener("error",s=>{console.error("WebSocket error: "+s),this.ws.close()}),this}addEventListener(i,s,l){return this.ws.addEventListener(i,s,l),this}removeEventListener(i,s,l){return this.ws.removeEventListener(i,s,l),this}send(i){return this.isConnected?this.ws.send(i):console.error("WebSocket is not connected"),this}startHeartbeat(){this.stopHeartbeat(),this.heartbeatTimer=setInterval(()=>{this.isConnected&&this.send(this.heartbeatMsg)},this.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}reconnect(){this.isConnected||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),console.log(`Reconnecting in ${this.reconnectDelay/1e3} seconds...`),this.reconnectTimer=setTimeout(()=>{this.connect()},this.reconnectDelay))}close(i,s){this.ws.close(i,s)}}exports.exchangeArrP=o.exchangeArrP;exports.filterTree=o.filterTree;exports.findTreeItem=o.findTreeItem;exports.flatWithKey=o.flatWithKey;exports.getTreePath=o.getTreePath;exports.groupBy=o.groupBy;exports.reverseForEach=o.reverseForEach;exports.treeItemSetParent=o.treeItemSetParent;exports.dateFormat=d.dateFormat;exports.getDate=d.getDate;exports.EventBus=g.EventBus;exports.eventBus=g.eventBus;exports.aTagDownloadFile=t.aTagDownloadFile;exports.arrayBufferToBase64=t.arrayBufferToBase64;exports.base64ToArrayBuffer=t.base64ToArrayBuffer;exports.base64ToBlob=t.base64ToBlob;exports.exportFile=t.exportFile;exports.filesHandle=t.filesHandle;exports.getExcelFile=t.getExcelFile;exports.getExcelFile2=t.getExcelFile2;exports.getFile=t.getFile;exports.getImgFile=t.getImgFile;exports.getImgFile2=t.getImgFile2;exports.getInputFile=t.getInputFile;exports.getPdfFile=t.getPdfFile;exports.getPdfFile2=t.getPdfFile2;exports.getVideoFile=t.getVideoFile;exports.getVideoFile2=t.getVideoFile2;exports.getXmlFile=t.getXmlFile;exports.getXmlFile2=t.getXmlFile2;exports.getZipFile=t.getZipFile;exports.getZipFile2=t.getZipFile2;exports.readFileAs=t.readFileAs;exports._setInterval=r._setInterval;exports._setTimeout=r._setTimeout;exports.addEventListener=r.addEventListener;exports.compose=r.compose;exports.convertFn=r.convertFn;exports.copyText=r.copyText;exports.debounce=r.debounce;exports.debouncePromise=r.debouncePromise;exports.idleHandle=r.idleHandle;exports.idleRunTask=r.idleRunTask;exports.log=r.log;exports.performChunk=r.performChunk;exports.removeEventListener=r.removeEventListener;exports.throttle=r.throttle;exports.Decimal=n.Decimal;exports.add=n.add;exports.addBy=n.addBy;exports.digit2Uppercase=n.digit2Uppercase;exports.divide=n.divide;exports.excludeNaN=n.excludeNaN;exports.limitInteger=n.limitInteger;exports.multiply=n.multiply;exports.multiplyBy=n.multiplyBy;exports.scientificToNumber=n.scientificToNumber;exports.subtract=n.subtract;exports.cloneDeepWithDescriptors=a.cloneDeepWithDescriptors;exports.cloneWithDescriptors=a.cloneWithDescriptors;exports.getAssignKey=a.getAssignKey;exports.getOnlyGetterKey=a.getOnlyGetterKey;exports.getRawType=a.getRawType;exports.hasOwnProperty=a.hasOwnProperty;exports.isNullish=a.isNullish;exports.pickAssigns=a.pickAssigns;exports.pickOnlyGetter=a.pickOnlyGetter;exports.transformSetVal=a.transformSetVal;exports.Storage=c.Storage;exports.local=c.local;exports.session=c.session;exports.GBK=e.GBK;exports.Pinyin=e.Pinyin;exports.bufferToHexStr=e.bufferToHexStr;exports.bufferToStr=e.bufferToStr;exports.compareVersion=e.compareVersion;exports.getPascalCase=e.getPascalCase;exports.getRandom=e.getRandom;exports.getRandomStr=e.getRandomStr;exports.getSearchParams=e.getSearchParams;exports.getSearchString=e.getSearchString;exports.hexStrToBuffer=e.hexStrToBuffer;exports.hexStrToBuffer_CN=e.hexStrToBuffer_CN;exports.isCN=e.isCN;exports.isExternal=e.isExternal;exports.randomColor=e.randomColor;exports.send0X0A=e.send0X0A;exports.strLength_CN=e.strLength_CN;exports.strToBuffer=e.strToBuffer;exports.strToHexStr=e.strToHexStr;exports.strToUnicode=e.strToUnicode;exports.stringToBinary=e.stringToBinary;exports.subStr=e.subStr;exports.validAlphabets=e.validAlphabets;exports.validDate=e.validDate;exports.validEmail=e.validEmail;exports.validIDCard=e.validIDCard;exports.validLowerCase=e.validLowerCase;exports.validPhone=e.validPhone;exports.validPostalCode=e.validPostalCode;exports.validURL=e.validURL;exports.validUpperCase=e.validUpperCase;exports.WebSocketClient=h;
