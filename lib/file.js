"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function a(i,t){return new Promise((n,e)=>{const l=new FileReader;l["readAs"+t](i),l.onload=c=>{n(c.target.result)},l.onerror=c=>{e(c)}})}async function s(i={multiple:!1}){try{const t=[],n=await window.showOpenFilePicker(i);for(const e of n){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}async function u(i=[]){try{const t=[];for(const n of i){const e=await a(n,"DataURL");t.push({dataURL:e,file:n})}return t}catch(t){return Promise.reject(t)}}const p={types:[{description:"选择图片",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excludeAcceptAllOption:!0};async function f(i={multiple:!1},t=!1){try{const n=[],e=await window.showOpenFilePicker({...p,...i});for(const l of e){const c=await l.getFile();if(t){const o=await a(c,"DataURL");n.push({dataURL:o,file:c});continue}n.push({file:c})}return n}catch(n){return Promise.reject(n)}}const m={types:[{description:"选择excel表格",accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0};async function g(i={multiple:!1}){try{const t=[],n=await window.showOpenFilePicker({...m,...i});for(const e of n){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}const d={types:[{description:"选择xml文件",accept:{"xml/*":[".xml"]}}],excludeAcceptAllOption:!0};async function F(i={multiple:!1}){try{const t=[],n=await window.showOpenFilePicker({...d,...i});for(const e of n){const l=await e.getFile();t.push(l)}return t}catch(t){return Promise.reject(t)}}async function r(i={multiple:!1}){return new Promise((t,n)=>{try{const e=document.createElement("input");e.type="file",i.multiple&&(e.multiple="multiple"),e.accept=i.accept,e.onchange=l=>{t([...l.target.files])},e.click()}catch(e){n(e)}})}async function w(i={multiple:!1},t=!1){return r({...i,accept:"image/*"}).then(n=>t?Promise.all(n.map(e=>a(e,"DataURL").then(l=>({dataURL:l,file:e})))):n.map(e=>({file:e})))}async function h(i={multiple:!1},t=!1){return r({...i,accept:"video/*"}).then(n=>t?Promise.all(n.map(e=>a(e,"DataURL").then(l=>({dataURL:l,file:e})))):n.map(e=>({file:e})))}async function y(i={multiple:!1}){return r({...i,accept:".xls,.xlsx"})}async function x(i={multiple:!1}){return r({...i,accept:"xml/*"})}function P(i,t){const n=URL.createObjectURL(i),e=document.createElement("a");e.href=n,e.download=t,e.click(),setTimeout(()=>{URL.revokeObjectURL(n)},5e3)}function L(i){const t=i.split(","),n=window.atob(t[1]),e=t[0].match(/:(.*?);/)[1],l=new Uint8Array(n.length);for(var c=0;c<n.length;c++)l[c]=n.charCodeAt(c);return new Blob([l],{type:e})}function A(i){const t=new ArrayBuffer(i.length),n=new Uint8Array(t);for(let e=0;e<i.length;e++)n[e]=i[e].charCodeAt(e).toString(2);return t}exports.base64ToBlob=L;exports.exportFile=P;exports.getExcelFile=g;exports.getExcelFile2=y;exports.getFile=s;exports.getImgFile=f;exports.getImgFile2=w;exports.getInputFile=r;exports.getVideoFile2=h;exports.getXmlFile=F;exports.getXmlFile2=x;exports.imgFilesHandle=u;exports.readFileAs=a;exports.stringToBinary=A;
